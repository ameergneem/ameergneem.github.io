<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
<link rel="stylesheet" type="text/css" href="bars.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>

<link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel = "stylesheet">
<script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<script src="https://d3js.org/d3.v4.min.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel = "stylesheet">
<script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<script src="https://d3js.org/d3.v4.min.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>
<style>
td.details-control {
    background: url('../resources/details_open.png') no-repeat center center;
    cursor: pointer;
}
tr.shown td.details-control {
    background: url('../resources/details_close.png') no-repeat center center;
}

</style>
<body>

<div class="w3-container">
<h1 style="text-align: center;text-decoration:underline">Sentement Analysis of Books Reviews Using IBM Watson</h1>
<h4 style="text-decoration:underline" >Introduction:</h4>
<p>This project was made with the guidance of Dr. Yael Netzer from 'Ben Gurion' university, as a final project of the course 'Advance Topics in Digital Humanities'</p>
<dl>

<dt>The project divided to two parts:</dt> 
<dd>- Goodreads reviews Analysis</dd>
<dd>- New York Times reviews Analysis</dd>

</dl>
<p>It is worth noticing that the number of reviews i got from Goodreads, is tremendously higher than those from New York Times.</p>
<dl>
        <dt>In this project i used IBM Watson AI to discover number of things:</dt>
        <dd>- How accurate IBM Watson is?, and whether or not its analysis ability is trustful.</dd>
        <dd> - How, generally, people review books (in terms of sentement), and how much their ratings (represented by stars)
                 can affect their reviews.</dd>
                <dd>- Do they write what they really meant? how much their reviews describe their ratings?  
        </dd>
        <dd>- Sentement analysis by genre, which genres the reviewers prefer the most.</dd>
        <dd>- How NYT reviewers review books published in different decades? in which decade they reviewed the most? </dd>
      </dl>


 <dl>
        <dt style="color: red; text-decoration:underline">Note:</dt>
<dt>Because of limited technical and time capabilities, i couldn't manage to get all the data (mostly reviews) from 
        both sites (New York Times and Goodreads), so the data in this project represent <em> a small portion of the data</em>
        provided by both sites:</dt>
<dd>- Goodreads: 54712 reviews</dd>
<dd>- New York Times: 1536 reviews</dd>
 </dl>
</div>

<br>

<br>
<br>


<div class="w3-container">
<h4 style="text-decoration:underline; text-align: center" >Goodreads Analysis</h4>
<br>
<br>
<div id='cont'  style="text-align: center"  ></div>
<h5 style="margin-left: 20%;text-decoration:underline;font-weight:bold">Graph Explanation and Conclusions:</h5>
<dl style="margin-left: 20%">
<dt >
We will discuss the above graph through two prospectives: 
</dt>
<dd><h style="text-decoration:underline;font-weight:bold">IBM Watson analysis ability:</h> We can see that Watson's ability to apply sentement analysis on reviews, is pretty impressive.
    the results are making sense for the human mind, the positive-negative ratio keeps increasing, in other words, from 'one star'
    rating to 'five stars' rating, the 'Positive' bar increases gradually, while the 'Negative' bar decreases ,also, gradually. 
</dd>
<dd>
<h style="text-decoration:underline;font-weight:bold">Peoples' reviewing habits:</h>
Which we can break into two main habits

    <dd>
        * By looking at the 'OneStar' colliction of bars and the 'FiveStars' colliction of bars, and comparing the RATIO between
          the 'Positive' bar and the 'Negative' bar in both collections we can see that the ratio in the 'FiveStars' bar is BIGGER than
          the one in the 'OneStar' collection. The reason in my opinion is that the reviewer tends to be amazed by the book, so
          he writes just about what is good about it (see for example 'FourStars' collection, although the 'Negative' reviews are
          nearly at the same number, but the 'Positive' are alot different).
          in the other hand, if the reviewer gives 'one star' for the book, in his review he may mention some few good words, not necessarly about
          the book but maybe about the author (e.g. "...i read a great books wrote by this auther, but..." ...)  
    </dd>

    <dd>
        * Although the data i collected considered just a sample, but we can see that the people are tend to rate 'five stars'.Generally,
        they avoid to rate 'one star'.


    </dd>
</dd>


</dl>
    </div>
    <br>
    <br>
    <br>
    <div class="w3-container">
            <h5 style="text-decoration:underline; text-align: center" >Genres Analysis</h5>
        <table id="GenresTable" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th></th>
                        <th>Genre</th>
                        <th>Positive Reviews</th>
                        <th>Neutral Reviews</th>
                        <th>Negative Reviews</th>
                        <th>Reviews Count</th>
        
        
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                            <th></th>
                        <th>Genre</th>
                        <th>Positive Reviews</th>
                        <th>Neutral Reviews</th>
                        <th>Negative Reviews</th>
                        <th>Reviews Count</th>
        
                    </tr>
                </tfoot>
            </table>

            <h6 style="margin-left: 20%;text-decoration:underline;font-weight:bold">Table Explanation:</h6>
            <p style="margin-left: 20%;">The above table shows the genres of the books that the reviews related to them.The table 
                is interactable, the we can sort by any parameter appears as column and even search.
                There are 62 genres, for every genre the table provides the number of reviews for it, and a portion of
                positive, neutral, or negative reviews. If the portion of the positive review is higher than the negative ones,
                it is indicated in green, if the negative is higher it is indicated in red, if both are equal, both are indicated in yellow.
            </p>



        </div>
        <br>
        <br>
        <div class="w3-container">
                <h4 style="text-decoration:underline; text-align: center" >New York Times Analysis</h4>
                <br>
                <br>
            <div id='cont2'>
                </div>


            </div>

    <table id="NYTimesTable" class="display" style="width:100%">
        <thead>
            <tr>
                <th></th>
                <th>Book Name</th>
                <th>Sentement</th>
                <th>Goodreads Average Rating</th>
                <th>Goodreads Ratings Count</th>


            </tr>
        </thead>
        <tfoot>
            <tr>
                <th></th>
                <th>Book Name</th>
                <th>Sentement</th>
                <th>Goodreads Average Rating</th>
                <th>Goodreads Ratings Count</th>

            </tr>
        </tfoot>
    </table>

    

</body>
<script>

 
$(document).ready(function() {

    var table = $('#GenresTable').DataTable( {   

        "ajax": "sentementCountPerGenres.txt",
        "columns": [
            {
                "className":      'details-control',
                "orderable":      false,
                "data":           null,
                "defaultContent": ''
            },
            { "data": "genre" },
            { "data": "positivePer" },
            { "data": "neutralPer" },
            { "data": "negativePer" },
            { "data": "sum" }

        ],
        "order": [[1, 'asc']],
        "columnDefs": [
    {
        targets: "_all",
        className: 'dt-body-center'
    }
  ],


        'rowCallback': function(row, data, index){
   
   if(data.positivePer > data.negativePer){
       $(row).find('td:eq(2)').css('color', 'green');
   }else{
    if(data.negativePer > data.positivePer)
       $(row).find('td:eq(4)').css('color', 'red');
   }
   if(data.negativePer == data.positivePer){
        $(row).find('td:eq(2)').css('color', 'orange');
        $(row).find('td:eq(4)').css('color', 'orange');
   }

}

    } );




    var table = $('#DecadesTable').DataTable( {   

"ajax": "sentementCountPerGenres.txt",
"columns": [
    {
        "className":      'details-control',
        "orderable":      false,
        "data":           null,
        "defaultContent": ''
    },
    { "data": "genre" },
    { "data": "positivePer" },
    { "data": "neutralPer" },
    { "data": "negativePer" },
    { "data": "sum" }

],
"order": [[1, 'asc']],
"columnDefs": [
{
targets: "_all",
className: 'dt-body-center'
}
],


'rowCallback': function(row, data, index){

if(data.positivePer > data.negativePer){
$(row).find('td:eq(2)').css('color', 'green');
}else{
if(data.negativePer > data.positivePer)
$(row).find('td:eq(4)').css('color', 'red');
}
if(data.negativePer == data.positivePer){
$(row).find('td:eq(2)').css('color', 'orange');
$(row).find('td:eq(4)').css('color', 'orange');
}

}

} );

//////////////////////////////////////////////////

    function format ( d ) {
    
    return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+
        '<tr>'+
            '<td>\'New York Times\' Review:</td>'+
            '<td><a target="_blank"  href="'+d.url+'">'+d.url+'</td>'+
        '</tr>'+
        '<tr>'+
            '<td>\'Goodreads\' Book Page:</td>'+
            '<td><a target="_blank"  href="'+d.GoodreadsURL+'">'+d.GoodreadsURL+'</td>'+
        '</tr>'+
    '</table>';
    
}


    var table = $('#NYTimesTable').DataTable( {   

        "ajax": "objectsUpd3.txt",
        "columns": [
            {
                "className":      'details-control',
                "orderable":      false,
                "data":           null,
                "defaultContent": ''
            },
            { "data": "bookName" },
            { "data": "sentement" },
            { "data": "GoodReadsRating" },
            { "data": "RatingsCount" }

        ],
        "order": [[1, 'asc']],
        "columnDefs": [
    {
        targets: "_all",
        className: 'dt-body-center'
    }
  ],


        'rowCallback': function(row, data, index){
   
   if(data.sentement == 'Positive'){
       $(row).find('td:eq(2)').css('color', 'green');
   }else{
       $(row).find('td:eq(2)').css('color', 'red');
   }
}
    } );


    // Add event listener for opening and closing details
    $('#NYTimesTable').children('tbody').on('click', 'td.details-control', function () {
        var tr = $(this).closest('tr');
        var row = table.row( tr );
 
        if ( row.child.isShown() ) {
            // This row is already open - close it
            row.child.hide();
            tr.removeClass('shown');
        }
        else {
            // Open this row
            row.child( format(row.data()) ).show();
            tr.addClass('shown');
        }
    } );


///////////////////////////

} );


</script>

<script src="starsBars.js"> 
</script>

<script src="decadesBars.js"> 
</script>
</html>
